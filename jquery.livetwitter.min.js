(function(a){if(!a.fn.reverse){a.fn.reverse=function(){return this.pushStack(this.get().reverse(),arguments)}}a.fn.liveTwitter=function(c,b){a(this).each(function(){var d={};if(this.twitter){d=jQuery.extend(this.twitter.settings,b);this.twitter.settings=d;if(c){this.twitter.query=c}this.twitter.limit=d.limit;this.twitter.mode=d.mode;if(this.twitter.interval){this.twitter.refresh()}}else{d=jQuery.extend({mode:"search",rate:15000,limit:10},b);window.twitter_callback=function(){return true};this.twitter={settings:d,query:c,limit:d.limit,mode:d.mode,interval:false,container:this,lastTimeStamp:0,relativeTime:function(f){var e=Date.parse(f);var h=(Date.parse(Date())-e)/1000;var g="";if(h<60){g="a moment ago"}else{if(h<120){g="a couple of minutes ago"}else{if(h<(45*60)){g=(parseInt(h/60,10)).toString()+" minutes ago"}else{if(h<(90*60)){g="an hour ago"}else{if(h<(24*60*60)){g=""+(parseInt(h/3600,10)).toString()+" hours ago"}else{if(h<(48*60*60)){g="a day ago"}else{g=(parseInt(h/86400,10)).toString()+" days ago"}}}}}}return g},refresh:function(e){var g=encodeURIComponent(this.query);var h=this;var f="";if(h.mode=="search"){f="http://search.twitter.com/search.json?q="+g+"&callback=?"}else{if(h.mode=="user_timeline"){f="http://twitter.com/statuses/user_timeline/"+g+".json?count=5&callback=?"}}a.getJSON(f,function(j){var i=null;if(h.mode=="search"){i=j.results}else{i=j}a(h.container).find("span.time").each(function(){a(this).html(h.relativeTime(this.timeStamp))});a(i).reverse().each(function(){var l=this.text.replace(/[A-Za-z]+:\/\/[A-Za-z0-9-_]+\.[A-Za-z0-9-_:%&\?\/.=]+/,function(n){return n.link(n)});l=l.replace(/@[A-Za-z0-9_]+/,function(n){return n.link("http://twitter.com/"+n.replace(/^@/,""))});if(Date.parse(this.created_at)>h.lastTimeStamp){var m='<div class="tweet tweet-'+this.id+'">';if(h.mode=="search"){m+='<img width="24" height="24" src="'+this.profile_image_url+'" /><p class="text"><span class="username"><a href="http://twitter.com/'+this.from_user+'">'+this.from_user+"</a>:</span> "}else{m+='<p class="text"> '}m+=l+' <span class="time">'+h.relativeTime(this.created_at)+"</span></p></div>";a(h.container).prepend(m);var k=this.created_at;a(h.container).find("span.time:first").each(function(){this.timeStamp=k});if(!e){a(h.container).find(".tweet-"+this.id).hide().fadeIn()}h.lastTimeStamp=Date.parse(this.created_at)}});a(h.container).find("div.tweet:gt("+(h.limit-1)+")").remove()})},start:function(){var e=this;if(!this.interval){this.interval=setInterval(function(){e.refresh()},e.settings.rate);this.refresh(true)}},stop:function(){if(this.interval){clearInterval(this.interval);this.interval=false}}};this.twitter.start()}});return this}})(jQuery);